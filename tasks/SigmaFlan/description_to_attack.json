[
  {
    "instruction": "Question: Given that we are analyzing logs from a webserver, we are focusing on log entries where the HTTP method is 'GET'. Within these entries, what specific type of attack could be indicated by the presence of certain keywords such as '={{', '=%7B%7B', '=${', '=$%7B', '=<=', '=%3C%25=', '=@(', 'freemarker.template.utility.Execute', '.getClass().forName('javax.script.ScriptEngineManager')', and 'T(org.apache.commons.io.IOUtils)'? Exclude any entries where the HTTP status code is 404 from this analysis. Consider that these keywords are indicators of a type of exploitation attempt within web applications, and the attack might involve template injections or attempts to execute arbitrary code on the server side through the application's template engine.",
    "context": "",
    "output": "Answer: The given information may indicate attempts at Server-Side Template Injection (SSTI) sent via GET requests in access logs. This type of attack involves exploiting vulnerabilities in a web application's template engine, allowing an attacker to inject or execute arbitrary code on the server side through the template system. The specified keywords are indicative of various encoding patterns and specific code snippets commonly used to probe or execute SSTI attacks. Detecting such patterns in webserver logs, especially within GET requests, suggests that attackers are trying to identify or exploit SSTI vulnerabilities within the application.",
    "category": "SigmaFlan",
    "instruction_type": "description_to_attack",
    "parsed_raw_data": {
      "indicators": "Given that we are analyzing logs from a webserver, we are focusing on log entries where the HTTP method is 'GET'. Within these entries, what specific type of attack could be indicated by the presence of certain keywords such as '={{', '=%7B%7B', '=${', '=$%7B', '=<=', '=%3C%25=', '=@(', 'freemarker.template.utility.Execute', '.getClass().forName('javax.script.ScriptEngineManager')', and 'T(org.apache.commons.io.IOUtils)'? Exclude any entries where the HTTP status code is 404 from this analysis. Consider that these keywords are indicators of a type of exploitation attempt within web applications, and the attack might involve template injections or attempts to execute arbitrary code on the server side through the application's template engine.",
      "answer": "The given information may indicate attempts at Server-Side Template Injection (SSTI) sent via GET requests in access logs. This type of attack involves exploiting vulnerabilities in a web application's template engine, allowing an attacker to inject or execute arbitrary code on the server side through the template system. The specified keywords are indicative of various encoding patterns and specific code snippets commonly used to probe or execute SSTI attacks. Detecting such patterns in webserver logs, especially within GET requests, suggests that attackers are trying to identify or exploit SSTI vulnerabilities within the application."
    }
  },
  {
    "instruction": "Question: Which attack could be indicated by observing the following indicators in logs: In a Windows environment, specifically in the process creation category, an event capturing the execution of 'mshta.exe' with command lines containing references to file types such as 'vbscript', '.jpg', '.png', '.lnk', '.xls', '.doc', '.zip', and '.dll'? The main goal of these indicators is to highlight unusual use of 'mshta.exe' involving certain file types that might be used for stealthy operations or evasion techniques.",
    "context": "",
    "output": "Answer: The given information may indicate an attack where mshta.exe's suspicious execution patterns are being utilized, sometimes involving file polyglotism. Such usage aims to execute malicious scripts or applications under the guise of harmless file types, leveraging mshta.exe to bypass security measures.",
    "category": "SigmaFlan",
    "instruction_type": "description_to_attack",
    "parsed_raw_data": {
      "indicators": "Which attack could be indicated by observing the following indicators in logs: In a Windows environment, specifically in the process creation category, an event capturing the execution of 'mshta.exe' with command lines containing references to file types such as 'vbscript', '.jpg', '.png', '.lnk', '.xls', '.doc', '.zip', and '.dll'? The main goal of these indicators is to highlight unusual use of 'mshta.exe' involving certain file types that might be used for stealthy operations or evasion techniques.",
      "answer": "The given information may indicate an attack where mshta.exe's suspicious execution patterns are being utilized, sometimes involving file polyglotism. Such usage aims to execute malicious scripts or applications under the guise of harmless file types, leveraging mshta.exe to bypass security measures."
    }
  },
  {
    "instruction": "In the context of cyber-security monitoring, specifically with Windows process creation logs, if within a 5-minute timeframe, more than 5 instances of processes are initiated from a list including but not limited to arp.exe, at.exe, attrib.exe, cscript.exe, dsquery.exe, hostname.exe, ipconfig.exe, mimikatz.exe, nbtstat.exe, net.exe, netsh.exe, nslookup.exe, ping.exe, quser.exe, qwinsta.exe, reg.exe, runas.exe, sc.exe, schtasks.exe, ssh.exe, systeminfo.exe, taskkill.exe, telnet.exe, tracert.exe, wscript.exe, xcopy.exe, pscp.exe, copy.exe, robocopy.exe, certutil.exe, vssadmin.exe, powershell.exe, pwsh.exe, wevtutil.exe, psexec.exe, bcedit.exe, wbadmin.exe, icacls.exe, and diskpart.exe on a single machine, which kind of attack could this activity potentially indicate?",
    "context": "",
    "output": "The given information may indicate an attack involving multiple suspicious processes in a limited timeframe. This pattern of behavior can suggest an adversary is attempting reconnaissance, lateral movement, or executing various commands for malicious purposes within a Windows environment.",
    "category": "SigmaFlan",
    "instruction_type": "description_to_attack",
    "parsed_raw_data": {
      "indicators": "In the context of cyber-security monitoring, specifically with Windows process creation logs, if within a 5-minute timeframe, more than 5 instances of processes are initiated from a list including but not limited to arp.exe, at.exe, attrib.exe, cscript.exe, dsquery.exe, hostname.exe, ipconfig.exe, mimikatz.exe, nbtstat.exe, net.exe, netsh.exe, nslookup.exe, ping.exe, quser.exe, qwinsta.exe, reg.exe, runas.exe, sc.exe, schtasks.exe, ssh.exe, systeminfo.exe, taskkill.exe, telnet.exe, tracert.exe, wscript.exe, xcopy.exe, pscp.exe, copy.exe, robocopy.exe, certutil.exe, vssadmin.exe, powershell.exe, pwsh.exe, wevtutil.exe, psexec.exe, bcedit.exe, wbadmin.exe, icacls.exe, and diskpart.exe on a single machine, which kind of attack could this activity potentially indicate?",
      "answer": "The given information may indicate an attack involving multiple suspicious processes in a limited timeframe. This pattern of behavior can suggest an adversary is attempting reconnaissance, lateral movement, or executing various commands for malicious purposes within a Windows environment."
    }
  },
  {
    "instruction": "Q: A Linux system is being monitored for security threats. Which attack might be indicated by the following indicators detected in the system logs? The indicators include suspicious shell commands such as downloading executables with wget followed by changes to permissions (chmod +x), initiating files with wget and setting open permissions (chmod 777), running or stopping services to disable firewalls (service iptables stop, SuSEfirewall2 stop), using Python to create simple HTTP servers, interacting with the file system in a suspicious manner (changing to temporary, run, or mount directories), executing files from temporary directories, misuse of base64 for decoding operations, modifications to execute permissions on critical system paths, attempts to spawn pseudo-terminals, use of network communication tools like socat and netcat (nc), and several specific patterns that could indicate the presence of malware or the use of exploit frameworks (e.g., Metasploit). These activities include direct echo commands to binary, creating and modifying files in /tmp, especially with specific patterns like /tmp/haxhax, /tmp/ns_sploit, and using or copying essential binaries like ksh and sh into unusual locations. There are also indicators of attempts to exploit specific vulnerabilities, such as those found in Apache Struts, by executing unusual command sequences.",
    "context": "",
    "output": "A: The given information may indicate an attack involving suspicious shell commands used in various exploit codes. These activities reflect a broad spectrum of malicious behavior, from trying to disable security mechanisms and gaining unauthorized access to executing and spreading malware. Each of the detected commands points towards different techniques employed by attackers to exploit vulnerabilities, perform privilege escalation, or establish a foothold on the system. Detecting these commands in the system logs is crucial for identifying potential security breaches and stopping an attack in its tracks.",
    "category": "SigmaFlan",
    "instruction_type": "description_to_attack",
    "parsed_raw_data": {
      "indicators": "A Linux system is being monitored for security threats. Which attack might be indicated by the following indicators detected in the system logs? The indicators include suspicious shell commands such as downloading executables with wget followed by changes to permissions (chmod +x), initiating files with wget and setting open permissions (chmod 777), running or stopping services to disable firewalls (service iptables stop, SuSEfirewall2 stop), using Python to create simple HTTP servers, interacting with the file system in a suspicious manner (changing to temporary, run, or mount directories), executing files from temporary directories, misuse of base64 for decoding operations, modifications to execute permissions on critical system paths, attempts to spawn pseudo-terminals, use of network communication tools like socat and netcat (nc), and several specific patterns that could indicate the presence of malware or the use of exploit frameworks (e.g., Metasploit). These activities include direct echo commands to binary, creating and modifying files in /tmp, especially with specific patterns like /tmp/haxhax, /tmp/ns_sploit, and using or copying essential binaries like ksh and sh into unusual locations. There are also indicators of attempts to exploit specific vulnerabilities, such as those found in Apache Struts, by executing unusual command sequences.",
      "answer": "The given information may indicate an attack involving suspicious shell commands used in various exploit codes. These activities reflect a broad spectrum of malicious behavior, from trying to disable security mechanisms and gaining unauthorized access to executing and spreading malware. Each of the detected commands points towards different techniques employed by attackers to exploit vulnerabilities, perform privilege escalation, or establish a foothold on the system. Detecting these commands in the system logs is crucial for identifying potential security breaches and stopping an attack in its tracks."
    }
  },
  {
    "instruction": "What attack could be indicated by the following detection indicators on a Windows system, specifically within system service logs? The logs show events generated by the 'Service Control Manager' with an EventID of 7045. The detection criteria focus on the 'ImagePath' containing all of the following components: 'rundll32.exe', 'shell32.dll', 'shellexec_rundll', and 'powershell'. All these indicators must be present to satisfy the detection condition. Which type of attack might these indicators suggest is being attempted?",
    "context": "",
    "output": "The given information may indicate an attack of 'Obfuscated Powershell via RUNDLL LAUNCHER'. This is because the combination of 'rundll32.exe', 'shell32.dll', 'shellexec_rundll', and 'powershell' in the ImagePath, along with the specific EventID and Provider_Name, points towards an attempt to obscure a powershell command using a Rundll32 invocation method, which is a common technique used in evasive attacks.",
    "category": "SigmaFlan",
    "instruction_type": "description_to_attack",
    "parsed_raw_data": {
      "indicators": "What attack could be indicated by the following detection indicators on a Windows system, specifically within system service logs? The logs show events generated by the 'Service Control Manager' with an EventID of 7045. The detection criteria focus on the 'ImagePath' containing all of the following components: 'rundll32.exe', 'shell32.dll', 'shellexec_rundll', and 'powershell'. All these indicators must be present to satisfy the detection condition. Which type of attack might these indicators suggest is being attempted?",
      "answer": "The given information may indicate an attack of 'Obfuscated Powershell via RUNDLL LAUNCHER'. This is because the combination of 'rundll32.exe', 'shell32.dll', 'shellexec_rundll', and 'powershell' in the ImagePath, along with the specific EventID and Provider_Name, points towards an attempt to obscure a powershell command using a Rundll32 invocation method, which is a common technique used in evasive attacks."
    }
  },
  {
    "instruction": "Q: What attack could be indicated by detecting the following indicators in Windows process creation logs? The indicators include processes ending with '\\SelectMyParent.exe', command line arguments containing various permutations of 'PPID-spoof', 'spoof-ppid', 'ppid_spoof', 'spoof_ppid', 'ppidspoof', 'spoofppid', 'spoofedppid', or ' -spawnto '. Additionally, the 'OriginalFileName' field containing similar permutations indicating PPID spoofing, a 'Description' field value of 'SelectMyParent', and specific 'Imphash' values of '04d974875bd225f00902b4cad9af3fbc', 'a782af154c9e743ddf3f3eb2b8f3d16e', '89059503d7fbf470e68f7e63313da3ad', and 'ca28337632625c8281ab8a130b3d6bad'. Hashes containing these 'Imphash' values are also included as indicators.",
    "context": "",
    "output": "A: The given information may indicate an attack that uses parent process ID spoofing tools like Didier Stevens tool SelectMyParent.",
    "category": "SigmaFlan",
    "instruction_type": "description_to_attack",
    "parsed_raw_data": {
      "indicators": "What attack could be indicated by detecting the following indicators in Windows process creation logs? The indicators include processes ending with '\\SelectMyParent.exe', command line arguments containing various permutations of 'PPID-spoof', 'spoof-ppid', 'ppid_spoof', 'spoof_ppid', 'ppidspoof', 'spoofppid', 'spoofedppid', or ' -spawnto '. Additionally, the 'OriginalFileName' field containing similar permutations indicating PPID spoofing, a 'Description' field value of 'SelectMyParent', and specific 'Imphash' values of '04d974875bd225f00902b4cad9af3fbc', 'a782af154c9e743ddf3f3eb2b8f3d16e', '89059503d7fbf470e68f7e63313da3ad', and 'ca28337632625c8281ab8a130b3d6bad'. Hashes containing these 'Imphash' values are also included as indicators.",
      "answer": "The given information may indicate an attack that uses parent process ID spoofing tools like Didier Stevens tool SelectMyParent."
    }
  },
  {
    "instruction": "Which attack may be indicated by the following indicators observed in a Windows environment, specifically in the process creation category? The indicators include processes such as cmd.exe, cscript.exe, curl.exe, mshta.exe, powershell.exe, pwsh.exe, and wscript.exe acting as parent processes to rundll32.exe. Additionally, there are specific command line paths and exports to look for: paths contain ProgramData, Users\\Public, AppData\\Local\\Temp, and AppData\\Roaming; command line exports ending with specific strings such as 'aslr', 'bind', 'DrawThemeIcon', 'GG10', 'GL70', 'jhbvygftr', 'kjhbhkjvydrt', 'LS88', 'Motd', 'N115', 'next', 'Nikn', 'print', 'qqqb', 'qqqq', 'RS32', 'Test', 'Time', 'Updt', 'vips', 'Wind', 'WW50', 'X555', 'XL55', 'xlAutoOpen', and 'XS88'.",
    "context": "",
    "output": "The given information may indicate an attack involving the specific process tree behavior of a 'rundll32' execution with exports linked with Qakbot activity.",
    "category": "SigmaFlan",
    "instruction_type": "description_to_attack",
    "parsed_raw_data": {
      "indicators": "Which attack may be indicated by the following indicators observed in a Windows environment, specifically in the process creation category? The indicators include processes such as cmd.exe, cscript.exe, curl.exe, mshta.exe, powershell.exe, pwsh.exe, and wscript.exe acting as parent processes to rundll32.exe. Additionally, there are specific command line paths and exports to look for: paths contain ProgramData, Users\\Public, AppData\\Local\\Temp, and AppData\\Roaming; command line exports ending with specific strings such as 'aslr', 'bind', 'DrawThemeIcon', 'GG10', 'GL70', 'jhbvygftr', 'kjhbhkjvydrt', 'LS88', 'Motd', 'N115', 'next', 'Nikn', 'print', 'qqqb', 'qqqq', 'RS32', 'Test', 'Time', 'Updt', 'vips', 'Wind', 'WW50', 'X555', 'XL55', 'xlAutoOpen', and 'XS88'.",
      "answer": "The given information may indicate an attack involving the specific process tree behavior of a 'rundll32' execution with exports linked with Qakbot activity."
    }
  },
  {
    "instruction": "In the context of Windows registry settings, which attack could be indicated by a registry set event where the 'EventType' is 'SetValue', the 'TargetObject' ends with '\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\AllowMultipleTSSessions', and the 'Details' field ends with 'DWORD (0x00000001)'? Consider that this detection focuses on attempts to enable a specific Windows functionality and explain how each selection indicator contributes to identifying this attack.",
    "context": "",
    "output": "The given indicators may signal an attack where the 'AllowMultipleTSSessions' value is enabled to allow for multiple Remote Desktop connection sessions to be opened simultaneously. This capability is often exploited by attackers as a means to connect to an RDP session without disconnecting other users, thereby maintaining unauthorized access or increasing the stealthiness of their activities within a compromised system.",
    "category": "SigmaFlan",
    "instruction_type": "description_to_attack",
    "parsed_raw_data": {
      "indicators": "In the context of Windows registry settings, which attack could be indicated by a registry set event where the 'EventType' is 'SetValue', the 'TargetObject' ends with '\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\AllowMultipleTSSessions', and the 'Details' field ends with 'DWORD (0x00000001)'? Consider that this detection focuses on attempts to enable a specific Windows functionality and explain how each selection indicator contributes to identifying this attack.",
      "answer": "The given indicators may signal an attack where the 'AllowMultipleTSSessions' value is enabled to allow for multiple Remote Desktop connection sessions to be opened simultaneously. This capability is often exploited by attackers as a means to connect to an RDP session without disconnecting other users, thereby maintaining unauthorized access or increasing the stealthiness of their activities within a compromised system."
    }
  },
  {
    "instruction": "Based on the indicators from a specific monitoring criterion, which attack could be identified by observing the process creation logs in Windows systems, focusing on the original file names 'mavinject32.exe' and 'mavinject64.exe', but excluding those events where the image path ends with '\\mavinject32.exe' or '\\mavinject64.exe'? What are the key selection criteria and conditions that may reveal this attack?",
    "context": "",
    "output": "The given information may indicate an attack involving the execution of a renamed version of the 'Mavinject' process. This technique can be abused to perform process injection using the '/INJECTRUNNING' flag. The key indicators involve monitoring for the creation of processes originating from 'mavinject32.exe' or 'mavinject64.exe' but explicitly filtering out any instances where these executions are directly from their default paths, suggesting an attempt to disguise the process injection by renaming the executable.",
    "category": "SigmaFlan",
    "instruction_type": "description_to_attack",
    "parsed_raw_data": {
      "indicators": "Based on the indicators from a specific monitoring criterion, which attack could be identified by observing the process creation logs in Windows systems, focusing on the original file names 'mavinject32.exe' and 'mavinject64.exe', but excluding those events where the image path ends with '\\mavinject32.exe' or '\\mavinject64.exe'? What are the key selection criteria and conditions that may reveal this attack?",
      "answer": "The given information may indicate an attack involving the execution of a renamed version of the 'Mavinject' process. This technique can be abused to perform process injection using the '/INJECTRUNNING' flag. The key indicators involve monitoring for the creation of processes originating from 'mavinject32.exe' or 'mavinject64.exe' but explicitly filtering out any instances where these executions are directly from their default paths, suggesting an attempt to disguise the process injection by renaming the executable."
    }
  },
  {
    "instruction": "In the context of Windows security logs, you notice an event with an EventID of 5379. This event specifically involves the opening of a password-protected ZIP file. The name of the ZIP file contains keywords that could potentially be related to financial transactions or orders such as 'invoice', 'new order', 'rechnung' (invoice in German), 'factura' (invoice in Spanish), 'delivery', 'purchase', 'order', or 'payment'. Given these indicators, which attack could these actions be an indication of?",
    "context": "",
    "output": "The given information may indicate an attack involving the extraction of password-protected ZIP archives with suspicious filenames. This could potentially be a method used by attackers to exfiltrate sensitive data under the guise of legitimate business documents.",
    "category": "SigmaFlan",
    "instruction_type": "description_to_attack",
    "parsed_raw_data": {
      "indicators": "In the context of Windows security logs, you notice an event with an EventID of 5379. This event specifically involves the opening of a password-protected ZIP file. The name of the ZIP file contains keywords that could potentially be related to financial transactions or orders such as 'invoice', 'new order', 'rechnung' (invoice in German), 'factura' (invoice in Spanish), 'delivery', 'purchase', 'order', or 'payment'. Given these indicators, which attack could these actions be an indication of?",
      "answer": "The given information may indicate an attack involving the extraction of password-protected ZIP archives with suspicious filenames. This could potentially be a method used by attackers to exfiltrate sensitive data under the guise of legitimate business documents."
    }
  }
]